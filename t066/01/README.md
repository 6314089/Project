#01
単一音源の基音周波数判定用MPMアルゴリズムを書く。

NSDF（SquaredDifferenceFunction）という、いい具合に正規化された自己相関関数のようなものを元に基音の周波数を判定する。

詳細は気が向いたら書きます。
（ここ "http://d.hatena.ne.jp/ku-ma-me/20120122/p1" と "A smarter way to find pitch" という論文が情報源です。）
（実装したコードについて、論文の(10)式について書かれていることが解読不可能だったので、その部分は誤魔化して書きました。そのため、実際のMPMアルゴリズムより精度に劣るものになっているかもしれません。）

#nsdf.m
Normalized Square Difference Functionを計算する。

#nsdfSlow.m
nsdfの非高速版。定義に従って書いただけで結構遅い。
nsdf.mが完成したので使っていない。

#getZeroCrossingMaxima.m
nsdfの結果から、最初のピークを除く各山の最大ピークを拾ってきて、その値とインデックスを返す関数。使っていない。

#getDelay.m
getZeroCrossingMaximaの省エネバージョン。しきい値を越えるピーク（＝基音周波数の位置にあると判断されるピーク）が見つかり次第、その大きさとインデックスを返す関数。

#parabol.m
与えられた3点を放物線補完して、その頂点のx位置を返す関数。
与えるのは3点のy成分のみで、x成分はそれぞれ -1, 0, 1 と仮定して計算している。
このため、これは汎用放物線補完関数では決してないことに注意。そもそも適当に書いたので間違っているかもしれない。

#mpm
信号、信号の周波数、解析対象とする信号の長さ、正規化（-1 ~ 1）されたしきい値ピークのしきい値（デフォルト0.8）を与えると、基音周波数を返してくれる関数。
解析対象とする長さの最大点数は、なんとなく、20000点までに制限している。
しきい値未満の値しかないなど、基音周波数が見つからないときは0を返す。
それ以前の段階で失敗している場合には-1を返す。-1が返ってきたら入力が不適切。

#stmpm
mpm用の引数に加えて、時間軸の刻み幅（サンプル点単位）を与えると、各時間幅に対してmpmを実行した結果をプロットする関数。この関数ではmpmに渡すしきい値の値は省略できない。
短時間フーリエ変換と似たような感覚。プロットされる横軸については時間に直せていない。各刻み幅についての情報が使われている。

#stmpmTest.m
例の "Riff2.m" に対してstmpmを実行するスクリプトファイル。
とてつもなくシンプルなので、mpmに渡される部分の幅やしきい値、ステップ等を変えてみるとコードの動きがわかりやすいかも。